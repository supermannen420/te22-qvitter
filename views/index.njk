{% extends "layout.njk" %}

{% block content %}
<main class="container region flow">
  <h1>{{ title }}</h1>
  <p>{{ message }}</p>
  <ul class="tweets flow">
    {% for tweet in tweets %}
      <li class="tweet">
        
          <header>
            <h2>{{ tweet.username }}</h2>
            <time datetime="{{ tweet.date }}">{{ tweet.date }}</time>

          </header>
          <p>{{ tweet.message }}</p>
          <footer>
            <ul></div>
                <div class="star">
                  <li class="star"><a href="">&#10150;</a></li>
                </div>
                <div class="star">
                  <li class="star"><a href="">&#8635;</a></li>
                </div>
                <div class="star">
                  <li class="star"><a href="">&#9734;</a></li>
                </div>
                <div class="star">
                  <li class="star"><a href="/tweets/{{ tweet.id }}/edit">&#xf5a1;</a></li>
                </div>
                <div class="Delete">
                  <li><a href="/tweets/{{ tweet.id }}/delete">&#128465;</a></li>
                </div>
            </ul>
          </footer>
        </article>
      </li>
     
    {% endfor %}
  </ul>
  <div class="nytt">
    <a href="/new">New Post</a>
  </div>
</main>
  <script>
  document.addEventListener("DOMContentLoaded", function() {
    const timeElements = document.querySelectorAll("time[datetime]");
    timeElements.forEach(timeElement => {
      const dateStr = timeElement.getAttribute("datetime");
      const date = new Date(dateStr); // Parse datetime string as is
      const now = new Date();
      const diffInSeconds = Math.floor((now - date) / 1000);
      const diffInMinutes = Math.floor(diffInSeconds / 60);
      const diffInHours = Math.floor(diffInMinutes / 60);
      const diffInDays = Math.floor(diffInHours / 24);

      let displayText;
      if (diffInDays > 0) {
        displayText = `${diffInDays} day${diffInDays > 1 ? 's' : ''} ago`;
      } else if (diffInHours > 0) {
        displayText = `${diffInHours} hour${diffInHours > 1 ? 's' : ''} ago`;
      } else if (diffInMinutes > 0) {
        displayText = `${diffInMinutes} minute${diffInMinutes > 1 ? 's' : ''} ago`;
      } else {
        displayText = `${diffInSeconds} second${diffInSeconds > 1 ? 's' : ''} ago`;
      }

      timeElement.textContent = displayText;
    });
  });
</script>
{% endblock %}